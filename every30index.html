<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>æ¯æ—¥ã¤ã¶ã‚„ãç‹¬ã‚Šè¨€è‹±èªï½œãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</title>
<style>
  :root{--cream:#fff7e6;--ink:#222;--accent:#f05a28;--ok:#2e7d32;--ng:#c62828;--card:#ffffff;--muted:#666;}
  html,body{margin:0;padding:0;background:var(--cream);color:var(--ink);font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
  header{position:sticky;top:0;z-index:5;background:linear-gradient(0deg,#ff7f50,var(--accent));color:#fff;padding:10px 14px;display:flex;align-items:center;gap:12px}
  header h1{font-size:16px;font-weight:700;margin:0;line-height:1.2}
  header small{opacity:.9;display:block}
  .wrap{max-width:880px;margin:12px auto 64px;padding:0 12px}
  .toolbar{display:grid;grid-template-columns:1fr;gap:10px;margin:10px 0 14px}
  @media(min-width:720px){ .toolbar{grid-template-columns: 2fr 1fr 1fr 1fr } }
  select,button{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #ddd;background:#fff;font-size:16px}
  button.primary{background:var(--accent);color:#fff;border:none}
  button.ghost{background:#fff;border:1px solid #ddd}
  button:disabled{opacity:.5;pointer-events:none}
  .card{background:var(--card);border-radius:16px;box-shadow:0 6px 18px rgba(0,0,0,.06);padding:16px}
  .meta{display:flex;align-items:baseline;gap:10px;color:var(--muted);font-size:14px;margin-bottom:6px}
  .q-ja{color:#c2185b;margin:8px 0 2px;font-size:22px}
  .q-en{font-size:22px;line-height:1.35;margin:8px 0 12px}
  .blank{border-bottom:3px solid #333; padding:0 2px}
  .choices{display:grid;gap:10px;margin-top:8px}
  .choice{background:#fff;border:2px solid #eee;border-radius:14px;padding:14px 16px;font-size:18px;text-align:center;cursor:pointer;transition:.15s}
  .choice:hover{transform:translateY(-1px)}
  .choice.correct{border-color:var(--ok);box-shadow:0 0 0 3px rgba(46,125,50,.12)}
  .choice.wrong{border-color:var(--ng);box-shadow:0 0 0 3px rgba(198,40,40,.1)}
  .feedback{margin-top:10px;font-weight:700}
  .feedback.ok{color:var(--ok)} .feedback.ng{color:var(--ng)}
  .footerBtns{margin-top:14px;display:grid;gap:10px;grid-template-columns:1fr 1fr}
  .scorebar{display:flex;gap:10px;align-items:center;margin:10px 0 0}
  .bar{height:10px;background:#eee;border-radius:999px;flex:1;overflow:hidden}
  .bar>span{display:block;height:100%;background:var(--ok);width:0%}
  .small{font-size:12px;color:var(--muted)}
  .pill{display:inline-block;background:#0000000d;border:1px solid #00000010;border-radius:999px;padding:4px 10px;margin-left:6px}
  .list{margin:6px 0 0;padding-left:18px}
</style>
</head>
<body>
<header>
  <div>
    <h1>æ¯æ—¥ã¤ã¶ã‚„ãç‹¬ã‚Šè¨€è‹±èª <small>Pattern Practice / 4æŠã‚¯ã‚¤ã‚º</small></h1>
    <small>å­¦ç¿’ãƒ¬ãƒ™ãƒ«ï¼š1æ—¥ç›®ã€œ30æ—¥ç›®ï¼ˆä¸»é¡Œã§é¸æŠï¼‰ï½œè‹±å›½è‹±èªã®éŸ³å£°ã¤ãï¼ˆã‚†ã£ãã‚Šï¼‰</small>
  </div>
</header>

<div class="wrap">
  <div class="toolbar">
    <select id="daySelect" title="å­¦ç¿’æ—¥ã‚’é¸æŠ"></select>
    <button id="modeAll" class="ghost" title="å…¨å•ãƒ¢ãƒ¼ãƒ‰">å…¨å•</button>
    <button id="modeWrong" class="ghost" title="èª¤ç­”ã®ã¿å¾©ç¿’">èª¤ç­”å¾©ç¿’</button>
    <button id="resetDay" class="ghost" title="ã“ã®æ—¥ã®æˆç¸¾ã‚’ãƒªã‚»ãƒƒãƒˆ">æˆç¸¾ãƒªã‚»ãƒƒãƒˆ</button>
  </div>

  <div class="card" id="quizCard" aria-live="polite">
    <div class="meta">
      <div id="titlePill" class="pill"></div>
      <div id="countPill" class="pill"></div>
      <div id="scorePill" class="pill"></div>
    </div>

    <div class="q-ja" id="qJa">æ—¥æœ¬èªè¨³ãŒå…¥ã‚Šã¾ã™</div>
    <div class="q-en" id="qEn">English sentence with a <span class="blank">blank</span>.</div>

    <div class="choices" id="choices"></div>
    <div id="feedback" class="feedback" role="status"></div>

    <div class="footerBtns">
      <button id="speakBtn" class="ghost" title="è‹±å›½è‹±èªã§èª­ã¿ä¸Šã’">ğŸ”ˆ è‹±æ–‡ã‚’éŸ³å£°ã§</button>
      <button id="nextBtn" class="primary" title="æ¬¡ã®å•é¡Œã¸">æ¬¡ã¸ â–¶ï¸</button>
    </div>

    <div class="scorebar">
      <div class="bar"><span id="barFill"></span></div>
      <div class="small" id="progressText">0 / 0</div>
    </div>
  </div>

  <div class="card" style="margin-top:14px">
    <details>
      <summary>ä½¿ã„æ–¹ãƒ»ãƒ‡ãƒ¼ã‚¿è¿½åŠ ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§é–‹ãï¼‰</summary>
      <ul class="list">
        <li>å„ä¾‹æ–‡ã¯ <b>id</b>ï¼ˆ001 ãªã©ï¼‰ã§ç®¡ç†ã€‚æˆç¸¾ã¨èª¤ç­”ã¯ç«¯æœ«ã«ä¿å­˜ï¼ˆlocalStorageï¼‰ã€‚</li>
        <li>ç©ºæ¬„ã¯ <code>_____</code> ã‚’å…¥ã‚ŒãŸã„éƒ¨åˆ†ã«ç½®ã„ã¦ã‚ã‚Šã¾ã™ã€‚</li>
        <li>4æŠã¯åŒæ—¥ã®ä»–èªã‹ã‚‰è‡ªå‹•ç”Ÿæˆã€‚å¿…è¦ãªã‚‰æ‰‹å‹•ã§ <code>options</code> ã‚’è¿½åŠ å¯ã€‚</li>
        <li>è‹±å›½è‹±èªã§ã‚†ã£ãã‚ŠéŸ³å£°ï¼šé€Ÿåº¦ 0.85ã€‚</li>
      </ul>
    </details>
  </div>
</div>

<script>
/* ========= â‘  å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ï¼ˆDay 1ã€œ30ã®ã†ã¡æ—¢å®šåˆ†ï¼‹Day12ã‚’è¿½åŠ ï¼‰ ========= */
const DATASET = [
  { day:1, theme:"ä½“ã‚„å¿ƒã®çŠ¶æ…‹ã‚’ã¤ã¶ã‚„ã", phrase:"Iâ€™m so ï½ï¼ˆï½ã ãªãï¼‰",
    items:[
      {id:"001",en:"I'm so _____.",answer:"thirsty",ja:"å–‰ãŒæ¸‡ã„ãŸãªãã€‚"},
      {id:"002",en:"I'm so _____.",answer:"sleepy",ja:"çœ ã„ãªãã€‚"},
      {id:"003",en:"I'm so _____.",answer:"busy",ja:"å¿™ã—ã„ãªãã€‚"},
      {id:"004",en:"I'm so _____.",answer:"nervous",ja:"ç·Šå¼µã™ã‚‹ãªãã€‚"},
      {id:"005",en:"I'm so _____.",answer:"lonely",ja:"å¯‚ã—ã„ãªãã€‚"},
      {id:"006",en:"I'm so _____.",answer:"happy",ja:"ã†ã‚Œã—ã„ãªãã€‚"},
      {id:"007",en:"I'm so _____.",answer:"sad",ja:"æ‚²ã—ã„ãªãã€‚"},
      {id:"008",en:"I'm so _____.",answer:"angry",ja:"è…¹ç«‹ã¤ãªãã€‚"},
      {id:"009",en:"I'm so _____.",answer:"lucky",ja:"ã¤ã„ã¦ã„ã‚‹ãªãã€‚"},
      {id:"010",en:"I'm so _____.",answer:"tired",ja:"ç–²ã‚ŒãŸãªãã€‚"},
      {id:"011",en:"I'm so _____.",answer:"hungry",ja:"ãŠè…¹ãŒç©ºã„ãŸãªãã€‚"},
      {id:"012",en:"I'm so _____.",answer:"full",ja:"ãŠè…¹ã„ã£ã±ã„ã ãªãã€‚"},
      {id:"013",en:"I'm so _____.",answer:"thirsty",ja:"å–‰ãŒã‚«ãƒ©ã‚«ãƒ©ã ãªãã€‚"},
      {id:"014",en:"I'm so _____.",answer:"sleepy",ja:"çœ ãã¦ãŸã¾ã‚‰ãªã„ãªãã€‚"},
      {id:"015",en:"I'm so _____.",answer:"cold",ja:"å¯’ã„ãªãã€‚"},
      {id:"016",en:"I'm so _____.",answer:"hot",ja:"æš‘ã„ãªãã€‚"},
      {id:"017",en:"I'm so _____.",answer:"shocked",ja:"ã‚·ãƒ§ãƒƒã‚¯ã ãªãã€‚"},
      {id:"018",en:"I'm so _____.",answer:"exhausted",ja:"ã‚‚ã†ããŸããŸã€‚"},
      {id:"019",en:"I'm so _____.",answer:"bored",ja:"é€€å±ˆã ãªãã€‚"},
      {id:"020",en:"I'm so _____.",answer:"excited",ja:"ã‚ãã‚ãã™ã‚‹ãªãã€‚"},
      {id:"021",en:"I'm so _____.",answer:"embarrassed",ja:"æ¥ãšã‹ã—ã„ãªãã€‚"},
      {id:"022",en:"I'm so _____.",answer:"confused",ja:"ã‚ã‘ãŒã‚ã‹ã‚‰ãªã„ãªãã€‚"},
      {id:"023",en:"I'm so _____.",answer:"disappointed",ja:"ãŒã£ã‹ã‚Šã ãªãã€‚"},
    ]},

  { day:2, theme:"äººã®æ€§æ ¼ãƒ»æ€§è³ªã‚’ã¤ã¶ã‚„ã", phrase:"Youâ€™re so ï½ï¼ˆã‚ãªãŸã¯ï½ã ãªãï¼‰",
    items:[
      {id:"001",en:"You're so _____.",answer:"smart",ja:"ã‚ãªãŸã¯é ­ãŒã„ã„ãªã‚ã€‚"},
      {id:"002",en:"You're so _____.",answer:"nice",ja:"ã‚ãªãŸã¯å„ªã—ã„ãªã‚ã€‚"},
      {id:"003",en:"You're so _____.",answer:"beautiful",ja:"ã‚ãªãŸã¯ç¾ã—ã„ãªã‚ã€‚"},
      {id:"004",en:"You're so _____.",answer:"handsome",ja:"ã‚ãªãŸã¯ãƒãƒ³ã‚µãƒ ã ãªã‚ã€‚"},
      {id:"005",en:"You're so _____.",answer:"cute",ja:"ã‚ãªãŸã¯ã‹ã‚ã„ã„ãªã‚ã€‚"},
      {id:"006",en:"You're so _____.",answer:"funny",ja:"ã‚ãªãŸã¯ãŠã‚‚ã—ã‚ã„ãªã‚ã€‚"},
      {id:"007",en:"You're so _____.",answer:"kind",ja:"ã‚ãªãŸã¯è¦ªåˆ‡ã ãªã‚ã€‚"},
      {id:"008",en:"You're so _____.",answer:"patient",ja:"ã‚ãªãŸã¯è¾›æŠ±å¼·ã„ãªã‚ã€‚"},
      {id:"009",en:"You're so _____.",answer:"honest",ja:"ã‚ãªãŸã¯æ­£ç›´ã ãªã‚ã€‚"},
      {id:"010",en:"You're so _____.",answer:"reliable",ja:"ã‚ãªãŸã¯é ¼ã‚Šã«ãªã‚‹ãªã‚ã€‚"},
      {id:"011",en:"You're so _____.",answer:"friendly",ja:"ã‚ãªãŸã¯äººãªã¤ã£ã“ã„ãªã‚ã€‚"},
      {id:"012",en:"You're so _____.",answer:"generous",ja:"ã‚ãªãŸã¯æ°—å‰ãŒã„ã„ãªã‚ã€‚"},
      {id:"013",en:"You're so _____.",answer:"polite",ja:"ã‚ãªãŸã¯ç¤¼å„€æ­£ã—ã„ãªã‚ã€‚"},
      {id:"014",en:"You're so _____.",answer:"energetic",ja:"ã‚ãªãŸã¯å…ƒæ°—ã ãªã‚ã€‚"},
      {id:"015",en:"You're so _____.",answer:"positive",ja:"ã‚ãªãŸã¯å‰å‘ãã ãªã‚ã€‚"},
      {id:"016",en:"You're so _____.",answer:"creative",ja:"ã‚ãªãŸã¯å‰µé€ çš„ã ãªã‚ã€‚"},
      {id:"017",en:"You're so _____.",answer:"serious",ja:"ã‚ãªãŸã¯çœŸé¢ç›®ã ãªã‚ã€‚"},
      {id:"018",en:"You're so _____.",answer:"shy",ja:"ã‚ãªãŸã¯æ¥ãšã‹ã—ãŒã‚Šå±‹ã ãªã‚ã€‚"},
      {id:"019",en:"You're so _____.",answer:"talkative",ja:"ã‚ãªãŸã¯ãŠã—ã‚ƒã¹ã‚Šã ãªã‚ã€‚"},
      {id:"020",en:"You're so _____.",answer:"quiet",ja:"ã‚ãªãŸã¯ç„¡å£ã ãªã‚ã€‚"},
      {id:"021",en:"You're so _____.",answer:"lazy",ja:"ã‚ãªãŸã¯æ€ ã‘è€…ã ãªã‚ã€‚"},
    ]},

  { day:3, theme:"æ›œæ—¥ãƒ»æ™‚é–“ã‚„ãã®æ—¥ã®çŠ¶æ³ã‚’ã¤ã¶ã‚„ã", phrase:"Itâ€™sï½",
    items:[
      {id:"001",en:"It's _____.",answer:"payday at last",ja:"ã‚„ã£ã¨çµ¦æ–™æ—¥ã ã€‚"},
      {id:"002",en:"It's _____.",answer:"Sunday at last",ja:"ã‚„ã£ã¨æ—¥æ›œæ—¥ã ã€‚"},
      {id:"003",en:"It's _____.",answer:"still Wednesday",ja:"ã¾ã æ°´æ›œæ—¥ã‹ã€‚"},
      {id:"004",en:"It's _____.",answer:"already Friday",ja:"ã‚‚ã†é‡‘æ›œæ—¥ã‹ã€‚"},
      {id:"005",en:"It's _____.",answer:"the beginning of the week",ja:"é€±ã®å§‹ã‚ã ã€‚"},
      {id:"006",en:"It's _____.",answer:"the end of the month",ja:"æœˆæœ«ã ã€‚"},
      {id:"007",en:"It's _____.",answer:"a national holiday",ja:"ç¥æ—¥ã ã€‚"},
      {id:"008",en:"It's _____.",answer:"the rush hour",ja:"ãƒ©ãƒƒã‚·ãƒ¥ã®æ™‚é–“ã ã€‚"},
      {id:"009",en:"It's _____?",answer:"about two o'clock",ja:"2æ™‚ãã‚‰ã„ã‹ãªã€‚"},
      {id:"010",en:"It's _____?",answer:"just after two",ja:"2æ™‚ã¡ã‚‡ã£ã¨éãã‹ã€‚"},
      {id:"011",en:"It's _____.",answer:"still half past three",ja:"ã¾ã 3æ™‚åŠã‹ã€‚"},
      {id:"012",en:"It's _____.",answer:"almost four",ja:"ã‚‚ã†ã™ã4æ™‚ã ã€‚"},
      {id:"013",en:"It's _____.",answer:"time for lunch",ja:"ãŠæ˜¼ã®æ™‚é–“ã ã€‚"},
      {id:"014",en:"It's _____.",answer:"sunny today",ja:"ä»Šæ—¥ã¯æ™´ã‚Œã€‚"},
      {id:"015",en:"It's _____.",answer:"cloudy today",ja:"ä»Šæ—¥ã¯ãã‚‚ã‚Šã€‚"},
      {id:"016",en:"It's _____.",answer:"rainy today",ja:"ä»Šæ—¥ã¯é›¨ã€‚"},
      {id:"017",en:"It's _____.",answer:"snowy today",ja:"ä»Šæ—¥ã¯é›ªã€‚"},
      {id:"018",en:"It's _____.",answer:"windy today",ja:"ä»Šæ—¥ã¯é¢¨ãŒå¼·ã„ã€‚"},
    ]},

  { day:4, theme:"ç›®ã®å‰ã®ã‚‚ã®ã«ã¤ã„ã¦ã¤ã¶ã‚„ã", phrase:"This isï½.",
    items:[
      {id:"001",en:"This is _____.",answer:"delicious",ja:"ã“ã‚Œã¨ã¦ã‚‚ç¾å‘³ã—ã„ã€‚"},
      {id:"002",en:"This is _____.",answer:"sour",ja:"ã“ã‚Œé…¸ã£ã±ã„ã€‚"},
      {id:"003",en:"This is _____.",answer:"salty",ja:"ã“ã‚Œã—ã‚‡ã£ã±ã„ã€‚"},
      {id:"004",en:"This is _____.",answer:"spicy",ja:"ã“ã‚Œè¾›ã„ã€‚"},
      {id:"005",en:"This is _____.",answer:"sweet",ja:"ã“ã‚Œç”˜ã„ã€‚"},
      {id:"006",en:"This is _____.",answer:"bitter",ja:"ã“ã‚Œè‹¦ã„ã€‚"},
      {id:"007",en:"This is _____.",answer:"hot",ja:"ã“ã‚Œç†±ã„ã€‚"},
      {id:"008",en:"This is _____.",answer:"cold",ja:"ã“ã‚Œå†·ãŸã„ã€‚"},
      {id:"009",en:"This is _____.",answer:"fresh",ja:"ã“ã‚Œæ–°é®®ã€‚"},
      {id:"010",en:"This is _____.",answer:"stale",ja:"ã“ã‚Œå¤ã„ã€‚"},
      {id:"011",en:"This is _____.",answer:"cheap",ja:"ã“ã‚Œå®‰ã„ã€‚"},
      {id:"012",en:"This is _____.",answer:"expensive",ja:"ã“ã‚Œé«˜ã„ã€‚"},
      {id:"013",en:"This is _____.",answer:"cute",ja:"ã“ã‚Œå¯æ„›ã„ã€‚"},
      {id:"014",en:"This is _____.",answer:"beautiful",ja:"ã“ã‚Œç¾ã—ã„ã€‚"},
      {id:"015",en:"This is _____.",answer:"heavy",ja:"ã“ã‚Œé‡ã„ã€‚"},
      {id:"016",en:"This is _____.",answer:"light",ja:"ã“ã‚Œè»½ã„ã€‚"},
      {id:"017",en:"This is _____.",answer:"strong",ja:"ã“ã®ã‚³ãƒ¼ãƒ’ãƒ¼æ¿ƒã„ã€‚"},
      {id:"018",en:"This is _____.",answer:"weak",ja:"ã“ã®ç´…èŒ¶è–„ã„ã€‚"},
    ]},

  { day:5, theme:"ä»Šè¡Œã‚ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ã¤ã¶ã‚„ã", phrase:"Iâ€™m playingï½now",
    items:[ {id:"001",en:"I'm playing _____ now.",answer:"in the yard",ja:"ä»Šåº­ã§éŠã‚“ã§ã‚‹ã€‚"} ]},

  { day:6, theme:"ã‚ã‚‹ã‚‚ã®ã‚’ã¤ã¶ã‚„ã", phrase:"Thereâ€™s aï½over there.",
    items:[
      {id:"001",en:"There's a _____ over there.",answer:"restroom",ja:"ã‚ã£ã¡ã«ãƒˆã‚¤ãƒ¬ãŒã‚ã‚‹ã€‚"},
      {id:"002",en:"There's a _____ over there.",answer:"bus stop",ja:"ã‚ã£ã¡ã«ãƒã‚¹åœãŒã‚ã‚‹ã€‚"},
      {id:"003",en:"There's a _____ over there.",answer:"taxi stand",ja:"ã‚ã£ã¡ã«ã‚¿ã‚¯ã‚·ãƒ¼ä¹—ã‚Šå ´ãŒã‚ã‚‹ã€‚"},
      {id:"004",en:"There's a _____ over there.",answer:"police box",ja:"ã‚ã£ã¡ã«äº¤ç•ªãŒã‚ã‚‹ã€‚"},
      {id:"005",en:"There's a _____ over there.",answer:"bank",ja:"ã‚ã£ã¡ã«éŠ€è¡ŒãŒã‚ã‚‹ã€‚"},
      {id:"006",en:"There's a _____ over there.",answer:"post office",ja:"ã‚ã£ã¡ã«éƒµä¾¿å±€ãŒã‚ã‚‹ã€‚"},
      {id:"007",en:"There's a _____ over there.",answer:"toilet",ja:"ã‚ã£ã¡ã«ãƒˆã‚¤ãƒ¬ãŒã‚ã‚‹ã€‚"},
      {id:"008",en:"There's a _____ today.",answer:"big sale",ja:"ä»Šæ—¥ã€å¤§ã‚»ãƒ¼ãƒ«ãŒã‚ã‚‹ã€‚"},
      {id:"009",en:"There's a _____ today.",answer:"meeting",ja:"ä»Šæ—¥ã¯ä¼šè­°ãŒã‚ã‚‹ã€‚"},
      {id:"010",en:"There's a lot to do today.",answer:"lot to do",ja:"ä»Šæ—¥ã¯ã™ã‚‹ã“ã¨ãŒãŸãã•ã‚“ã‚ã‚‹ã€‚"},
    ]},

  { day:7, theme:"å ´æ‰€ã«ã¤ã„ã¦ã¤ã¶ã‚„ã", phrase:"Whereâ€™s theï½?",
    items:[
      {id:"001",en:"Where's the _____?",answer:"toilet",ja:"ãƒˆã‚¤ãƒ¬ã¯ã©ã“ï¼Ÿ"},
      {id:"002",en:"Where's the _____?",answer:"exit",ja:"å‡ºå£ã¯ã©ã“ï¼Ÿ"},
      {id:"003",en:"Where's the _____?",answer:"entrance",ja:"å…¥å£ã¯ã©ã“ï¼Ÿ"},
      {id:"004",en:"Where's the _____?",answer:"stairs",ja:"éšæ®µã¯ã©ã“ï¼Ÿ"},
      {id:"005",en:"Where's the _____?",answer:"lift",ja:"ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ã¯ã©ã“ï¼Ÿ"},
      {id:"006",en:"Where's the _____?",answer:"escalator",ja:"ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ã©ã“ï¼Ÿ"},
      {id:"007",en:"Where's the _____?",answer:"information desk",ja:"æ¡ˆå†…æ‰€ã¯ã©ã“ï¼Ÿ"},
      {id:"008",en:"Where's the _____?",answer:"ticket machine",ja:"åˆ¸å£²æ©Ÿã¯ã©ã“ï¼Ÿ"},
      {id:"009",en:"Where's the _____?",answer:"platform 1",ja:"1ç•ªç·šã¯ã©ã“ï¼Ÿ"},
      {id:"010",en:"Where's the nearest _____?",answer:"station",ja:"ä¸€ç•ªè¿‘ã„é§…ã¯ã©ã“ï¼Ÿ"},
      {id:"011",en:"Where's the nearest _____?",answer:"bus stop",ja:"ä¸€ç•ªè¿‘ã„ãƒã‚¹åœã¯ã©ã“ï¼Ÿ"},
      {id:"012",en:"Where's the nearest _____?",answer:"supermarket",ja:"ä¸€ç•ªè¿‘ã„ã‚¹ãƒ¼ãƒ‘ãƒ¼ã¯ã©ã“ï¼Ÿ"},
      {id:"013",en:"Where's the _____?",answer:"ATM",ja:"ATMã¯ã©ã“ï¼Ÿ"},
      {id:"014",en:"Where's the _____?",answer:"pharmacy",ja:"è–¬å±€ã¯ã©ã“ï¼Ÿ"},
      {id:"015",en:"Where's the _____?",answer:"hospital",ja:"ç—…é™¢ã¯ã©ã“ï¼Ÿ"},
      {id:"016",en:"Where's the _____?",answer:"taxi rank",ja:"ã‚¿ã‚¯ã‚·ãƒ¼ä¹—ã‚Šå ´ã¯ã©ã“ï¼Ÿ"},
    ]},

  { day:8, theme:"ä¸­èº«ãƒ»å†…å®¹ã«é–¢ã™ã‚‹ç–‘å•ã‚’ã¤ã¶ã‚„ã", phrase:"Whatâ€™s theï½?",
    items:[
      {id:"001",en:"What's the _____?",answer:"time now",ja:"ä»Šã€ä½•æ™‚ï¼Ÿ"},
      {id:"002",en:"What's the _____?",answer:"temperature",ja:"æ°—æ¸©ã¯ä½•åº¦ï¼Ÿ"},
      {id:"003",en:"What's the _____?",answer:"problem",ja:"å•é¡Œã¯ä½•ï¼Ÿ"},
      {id:"004",en:"What's the _____?",answer:"password",ja:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ä½•ï¼Ÿ"},
      {id:"005",en:"What's the _____?",answer:"Wi-Fi password",ja:"Wi-Fiã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ï¼Ÿ"},
      {id:"006",en:"What's the _____?",answer:"agenda today",ja:"ä»Šæ—¥ã®äºˆå®šã¯ä½•ï¼Ÿ"},
      {id:"007",en:"What's the _____?",answer:"plan for tonight",ja:"ä»Šå¤œã®è¨ˆç”»ã¯ï¼Ÿ"},
      {id:"008",en:"What's the _____?",answer:"menu today",ja:"ä»Šæ—¥ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯ï¼Ÿ"},
      {id:"009",en:"What's the _____?",answer:"topic",ja:"ä»Šæ—¥ã®ãƒˆãƒ”ãƒƒã‚¯ã¯ï¼Ÿ"},
      {id:"010",en:"What's the _____?",answer:"issue",ja:"èª²é¡Œã¯ä½•ï¼Ÿ"},
      {id:"011",en:"What's the _____?",answer:"meaning of this",ja:"ã“ã‚Œã®æ„å‘³ã¯ä½•ï¼Ÿ"},
      {id:"012",en:"What's the _____?",answer:"best route",ja:"ãƒ™ã‚¹ãƒˆãªãƒ«ãƒ¼ãƒˆã¯ï¼Ÿ"},
      {id:"013",en:"What's the _____?",answer:"exchange rate",ja:"ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆã¯ï¼Ÿ"},
    ]},

  { day:9, theme:"æ—¥æ™‚ã«é–¢ã™ã‚‹ç–‘å•ã‚’ã¤ã¶ã‚„ã", phrase:"When isï½?",
    items:[
      {id:"001",en:"When is _____?",answer:"the next bus",ja:"æ¬¡ã®ãƒã‚¹ã¯ã„ã¤ï¼Ÿ"},
      {id:"002",en:"When is _____?",answer:"the next train",ja:"æ¬¡ã®é›»è»Šã¯ã„ã¤ï¼Ÿ"},
      {id:"003",en:"When is _____?",answer:"lunch time",ja:"æ˜¼ä¼‘ã¿ã¯ã„ã¤ï¼Ÿ"},
      {id:"004",en:"When is _____?",answer:"the meeting",ja:"ä¼šè­°ã¯ã„ã¤ï¼Ÿ"},
      {id:"005",en:"When is _____?",answer:"your birthday",ja:"ã‚ãªãŸã®èª•ç”Ÿæ—¥ã¯ã„ã¤ï¼Ÿ"},
    ]},

  { day:10, theme:"ã—ãŸã„ã“ã¨ã‚’ã¤ã¶ã‚„ã", phrase:"I want toï½",
    items:[
      {id:"001",en:"I want to _____.",answer:"drink water",ja:"æ°´ã‚’é£²ã¿ãŸã„ã€‚"},
      {id:"002",en:"I want to _____.",answer:"go to bed",ja:"å¯ãŸã„ã€‚"},
      {id:"003",en:"I want to _____.",answer:"eat something sweet",ja:"ç”˜ã„ã‚‚ã®ãŒé£Ÿã¹ãŸã„ã€‚"},
      {id:"004",en:"I want to _____.",answer:"take a nap",ja:"æ˜¼å¯ã—ãŸã„ã€‚"},
    ]},

  /* â–¼â–¼ 12æ—¥ç›®ï¼šã“ã‚Œã‹ã‚‰ã™ã‚‹ã“ã¨ã‚’ã¤ã¶ã‚„ã */
  { day:12, theme:"ã“ã‚Œã‹ã‚‰ã™ã‚‹ã“ã¨ã‚’ã¤ã¶ã‚„ã",
    phrase:"I'll ï½. / I'm thinking of ï½ing. / I'm going to ï½.",
    items:[
      {id:"001",en:"I'll _____.",answer:"prepare breakfast",ja:"æœé£Ÿã®æº–å‚™ã‚’ã—ã‚ˆã£ã¨ã€‚"},
      {id:"002",en:"I'll _____.",answer:"do the laundry",ja:"æ´—æ¿¯ã—ã‚ˆã£ã¨ã€‚"},
      {id:"003",en:"I'll _____.",answer:"vacuum the floor",ja:"åºŠã«æƒé™¤æ©Ÿã‚’ã‹ã‘ã‚ˆã£ã¨ã€‚"},
      {id:"004",en:"I'll _____.",answer:"take out the garbage",ja:"ã‚´ãƒŸã‚’å‡ºãã£ã¨ã€‚"},
      {id:"005",en:"I'll _____.",answer:"clean the toilet",ja:"ãƒˆã‚¤ãƒ¬ã‚’æƒé™¤ã—ã‚ˆã£ã¨ã€‚"},
      {id:"006",en:"I'll _____.",answer:"hang out the laundry",ja:"æ´—æ¿¯ç‰©å¹²ãã£ã¨ã€‚"},
      {id:"007",en:"I'll _____.",answer:"bring the laundry in",ja:"æ´—æ¿¯ç‰©å–ã‚Šè¾¼ã‚‚ã£ã€‚"},
      {id:"008",en:"I'll _____.",answer:"do the shopping",ja:"è²·ã„ç‰©ã—ã‚ˆã£ã¨ã€‚"},
      {id:"009",en:"I'm thinking of _____.",answer:"traveling around the world",ja:"ä¸–ç•Œæ—…è¡Œã‚’ã—ã‚ˆã†ã‹ãªã€‚"},
      {id:"010",en:"I'm going to _____.",answer:"study English in London",ja:"ãƒ­ãƒ³ãƒ‰ãƒ³ã§è‹±èªã‚’å‹‰å¼·ã™ã‚‹ã¤ã‚‚ã‚Šã€‚"},
      {id:"011",en:"I'm going to _____.",answer:"stay home today",ja:"ä»Šæ—¥ã¯å®¶ã«ã„ã‚‹ã¤ã‚‚ã‚Šã€‚"},
    ]},

  { day:11, theme:"å‘¨å›²ã®çŠ¶æ³ãƒ»çŠ¶æ…‹ã‚’ã¤ã¶ã‚„ã", phrase:"It looks/feelsï½",
    items:[
      {id:"001",en:"It looks _____.",answer:"cloudy outside",ja:"å¤–ã¯æ›‡ã£ã¦ã„ã‚‹ã‚ˆã†ã ã€‚"},
      {id:"002",en:"It looks _____.",answer:"busy today",ja:"ä»Šæ—¥ã¯å¿™ã—ãã†ã ã€‚"},
      {id:"003",en:"It feels _____.",answer:"cold today",ja:"ä»Šæ—¥ã¯å¯’ãæ„Ÿã˜ã‚‹ã€‚"},
    ]},

  { day:13, theme:"æ‰€æœ‰ãƒ»æ‰€å±ã‚’ãŸãšã­ã‚‹", phrase:"Whoseï½?",
    items:[
      {id:"001",en:"Whose _____ is this?",answer:"bag",ja:"ã“ã‚Œã¯èª°ã®ã‚«ãƒãƒ³ã‹ãªã€‚"},
      {id:"002",en:"Whose _____ are these?",answer:"shoes",ja:"ã“ã‚Œèª°ã®é´ã‹ãªã€‚"},
      {id:"003",en:"Whose _____ are these?",answer:"glasses",ja:"ã“ã‚Œèª°ã®çœ¼é¡ã‹ãªã€‚"},
    ]},

  { day:14, theme:"ç¾åœ¨é€²è¡Œã®è‡ªåˆ†ã”ã¨ã‚’ã¤ã¶ã‚„ã", phrase:"Iâ€™m ï½ing",
    items:[
      {id:"001",en:"I'm _____.",answer:"studying now",ja:"ä»Šã€å‹‰å¼·ã—ã¦ã„ã‚‹ã€‚"},
      {id:"002",en:"I'm _____.",answer:"cooking dinner",ja:"å¤•é£¯ã‚’ä½œã£ã¦ã„ã‚‹æœ€ä¸­ã€‚"},
      {id:"003",en:"I'm _____.",answer:"waiting for the bus",ja:"ãƒã‚¹ã‚’å¾…ã£ã¦ã„ã‚‹ã€‚"},
    ]},

  { day:15, theme:"éå»ã®å‡ºæ¥äº‹ã‚’ã¤ã¶ã‚„ã", phrase:"I ï½ed",
    items:[
      {id:"001",en:"I _____.",answer:"lost my keys",ja:"éµã‚’ãªãã—ãŸã€‚"},
      {id:"002",en:"I _____.",answer:"missed the bus",ja:"ãƒã‚¹ã«ä¹—ã‚Šé…ã‚ŒãŸã€‚"},
      {id:"003",en:"I _____.",answer:"broke my phone",ja:"æºå¸¯ã‚’å£Šã—ãŸã€‚"},
    ]},

  { day:16, theme:"è¨ˆç”»ãƒ»äºˆå®šã‚’ã¤ã¶ã‚„ã", phrase:"Iâ€™m going toï½",
    items:[
      {id:"001",en:"I'm going to _____.",answer:"study English tonight",ja:"ä»Šå¤œã¯è‹±èªã‚’å‹‰å¼·ã™ã‚‹ã¤ã‚‚ã‚Šã€‚"},
      {id:"002",en:"I'm going to _____.",answer:"visit my friend",ja:"å‹é”ã®å®¶ã«è¡Œãã¤ã‚‚ã‚Šã€‚"},
      {id:"003",en:"I'm going to _____.",answer:"clean the room",ja:"éƒ¨å±‹ã‚’æƒé™¤ã™ã‚‹ã¤ã‚‚ã‚Šã€‚"},
    ]},

  { day:17, theme:"è¨±å¯ãƒ»ä¾é ¼ã‚’ã¤ã¶ã‚„ã", phrase:"Can I ï½? / Could you ï½?",
    items:[
      {id:"001",en:"Can I _____?",answer:"use your phone",ja:"ã‚ãªãŸã®ã‚¹ãƒãƒ›ä½¿ã£ã¦ã‚‚ã„ã„ï¼Ÿ"},
      {id:"002",en:"Could you _____?",answer:"help me",ja:"æ‰‹ä¼ã£ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ"},
      {id:"003",en:"Could you _____?",answer:"speak slowly",ja:"ã‚†ã£ãã‚Šè©±ã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ"},
    ]},

  { day:18, theme:"å¥½ã¿ã‚’ã¤ã¶ã‚„ã", phrase:"I like / I prefer ï½",
    items:[
      {id:"001",en:"I like _____.",answer:"black tea",ja:"ç´…èŒ¶ãŒå¥½ãã€‚"},
      {id:"002",en:"I prefer _____.",answer:"cats to dogs",ja:"çŠ¬ã‚ˆã‚ŠçŒ«ãŒå¥½ãã€‚"},
      {id:"003",en:"I like _____.",answer:"quiet cafÃ©s",ja:"é™ã‹ãªã‚«ãƒ•ã‚§ãŒå¥½ãã€‚"},
    ]},

  { day:19, theme:"å¿…è¦ãƒ»ç¾©å‹™ã‚’ã¤ã¶ã‚„ã", phrase:"I need toï½ / I have toï½",
    items:[
      {id:"001",en:"I need to _____.",answer:"go shopping",ja:"è²·ã„ç‰©ã«è¡Œãå¿…è¦ãŒã‚ã‚‹ã€‚"},
      {id:"002",en:"I have to _____.",answer:"finish this today",ja:"ä»Šæ—¥ã¯ã“ã‚Œã‚’çµ‚ã‚ã‚‰ã›ãªã„ã¨ã€‚"},
      {id:"003",en:"I need to _____.",answer:"sleep earlier",ja:"ã‚‚ã£ã¨æ—©ãå¯ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚"},
    ]},

  { day:20, theme:"ææ¡ˆãƒ»å‹§èª˜ã‚’ã¤ã¶ã‚„ã", phrase:"Letâ€™s ï½ / Shall we ï½?",
    items:[
      {id:"001",en:"Let's _____.",answer:"have a break",ja:"å°‘ã—ä¼‘ã‚‚ã†ã€‚"},
      {id:"002",en:"Shall we _____?",answer:"go for a walk",ja:"æ•£æ­©ã«è¡Œãã¾ã›ã‚“ã‹ï¼Ÿ"},
      {id:"003",en:"Let's _____.",answer:"make some tea",ja:"ãŠèŒ¶ã‚’æ·¹ã‚Œã‚ˆã†ã€‚"},
    ]},

  { day:21, theme:"ãŠé¡˜ã„ãƒ»ä¸å¯§è¡¨ç¾ã‚’ã¤ã¶ã‚„ã", phrase:"Would you ï½? / Could I ï½?",
    items:[
      {id:"001",en:"Would you _____?",answer:"open the window",ja:"çª“ã‚’é–‹ã‘ã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ"},
      {id:"002",en:"Could I _____?",answer:"sit here",ja:"ã“ã“ã«åº§ã£ã¦ã‚‚ã„ã„ã§ã™ã‹ï¼Ÿ"},
      {id:"003",en:"Would you _____?",answer:"repeat that",ja:"ã‚‚ã†ä¸€åº¦è¨€ã£ã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ"},
    ]},

  { day:22, theme:"æ¨é‡ãƒ»å¯èƒ½æ€§ã‚’ã¤ã¶ã‚„ã", phrase:"It might / must ï½",
    items:[
      {id:"001",en:"It might be _____.",answer:"rain later",ja:"ã‚ã¨ã§é›¨ã‹ã‚‚ã—ã‚Œãªã„ã€‚"},
      {id:"002",en:"It must be _____.",answer:"hard",ja:"ãã£ã¨å¤§å¤‰ã ã€‚"},
    ]},

  { day:23, theme:"æ„Ÿè¬ãƒ»ãŠç¤¼ã‚’ã¤ã¶ã‚„ã", phrase:"Thank you for ï½",
    items:[
      {id:"001",en:"Thank you for _____.",answer:"your help",ja:"æ‰‹ä¼ã£ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ã€‚"},
      {id:"002",en:"Thank you for _____.",answer:"waiting",ja:"å¾…ã£ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ã€‚"},
    ]},

  { day:24, theme:"ç¦æ­¢ãƒ»æ³¨æ„ã‚’ã¤ã¶ã‚„ã", phrase:"Donâ€™t ï½.",
    items:[
      {id:"001",en:"Don't _____.",answer:"break into the line",ja:"åˆ—ã«å‰²ã‚Šè¾¼ã‚€ãªã‚ˆã€‚"},
      {id:"002",en:"Don't _____.",answer:"dash into the train",ja:"é§†ã‘è¾¼ã¿ä¹—è»Šã‚’ã™ã‚‹ãªã‚ˆã€‚"},
      {id:"003",en:"Don't _____.",answer:"talk in a loud voice",ja:"å¤§ããªå£°ã§ã—ã‚ƒã¹ã‚‹ãªã‚ˆã€‚"},
      {id:"004",en:"Don't _____.",answer:"step on my shoe",ja:"é´ã‚’è¸ã‚€ãªã‚ˆã€‚"},
      {id:"005",en:"Don't _____.",answer:"wear so much perfume",ja:"é¦™æ°´ã‚’ä»˜ã‘ã™ãã‚‹ãªã‚ˆã€‚"},
    ]},

  { day:25, theme:"åŠ©è¨€ãƒ»æŒ‡ç¤ºã‚’ã¤ã¶ã‚„ã", phrase:"Please ï½ / Make sure to ï½",
    items:[
      {id:"001",en:"Please _____.",answer:"be careful",ja:"æ°—ã‚’ã¤ã‘ã¦ã€‚"},
      {id:"002",en:"Make sure to _____.",answer:"lock the door",ja:"å¿…ãšéµã‚’ã‹ã‘ã¦ã€‚"},
    ]},

  { day:26, theme:"è¨±å¯ã‚’ä¸ãˆã‚‹ãƒ»å‹§ã‚ã‚‹", phrase:"You can ï½ / You should ï½",
    items:[
      {id:"001",en:"You can _____.",answer:"sit there",ja:"ãã“ã«åº§ã£ã¦ã„ã„ã‚ˆã€‚"},
      {id:"002",en:"You should _____.",answer:"take an umbrella",ja:"å‚˜ã‚’æŒã£ã¦è¡Œã£ãŸã»ã†ãŒã„ã„ã‚ˆã€‚"},
    ]},

  { day:27, theme:"å¸Œæœ›ãƒ»é¡˜æœ›ã‚’ã¤ã¶ã‚„ã", phrase:"I hope / I wish ï½",
    items:[
      {id:"001",en:"I hope _____.",answer:"it goes well",ja:"ã†ã¾ãã„ãã¾ã™ã‚ˆã†ã«ã€‚"},
      {id:"002",en:"I wish _____.",answer:"I had more time",ja:"ã‚‚ã£ã¨æ™‚é–“ãŒã‚ã‚Œã°ãªãã€‚"},
    ]},

  { day:28, theme:"æ¯”è¼ƒã—ã¦ã¤ã¶ã‚„ã", phrase:"â€¦ than ï½ / as â€¦ as ï½",
    items:[
      {id:"001",en:"This is _____ than that.",answer:"better",ja:"ã“ã‚Œã¯ã‚ã‚Œã‚ˆã‚Šè‰¯ã„ã€‚"},
      {id:"002",en:"I'm not as _____ as before.",answer:"tired",ja:"å‰ã»ã©ç–²ã‚Œã¦ã„ãªã„ã€‚"},
    ]},

  { day:29, theme:"ç¿’æ…£ãƒ»é »åº¦ã‚’ã¤ã¶ã‚„ã", phrase:"I usually / I often ï½",
    items:[
      {id:"001",en:"I usually _____.",answer:"study in the morning",ja:"ãŸã„ã¦ã„æœã«å‹‰å¼·ã™ã‚‹ã€‚"},
      {id:"002",en:"I often _____.",answer:"have tea in the afternoon",ja:"åˆå¾Œã«ç´…èŒ¶ã‚’ã‚ˆãé£²ã‚€ã€‚"},
    ]},
];

/* ========= â‘¡ çŠ¶æ…‹ç®¡ç† ========= */
const state = { day: 1, mode: "all", queue: [], idx: 0, lastResult: null };
const storeKey = d => `monotalk-v1-day${d}`;
function loadStore(day){ const raw = localStorage.getItem(storeKey(day)); return raw ? JSON.parse(raw) : {correct:[],wrong:[]}; }
function saveStore(day,data){ localStorage.setItem(storeKey(day), JSON.stringify(data)); }

/* ========= â‘¢ ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ========= */
function getDayData(day){ return DATASET.find(x=>x.day===day); }
function buildChoices(item, pool){
  if(item.options && item.options.length>=4) return shuffle(item.options.slice(0,4));
  const allWords = [...new Set(pool.map(i=>i.answer))];
  const wrongs = shuffle(allWords.filter(w=>w!==item.answer)).slice(0,3);
  return shuffle([item.answer, ...wrongs]);
}
function shuffle(arr){ return arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(p=>p[1]); }
function fillBlank(en, chunk){ return en.replace("_____", chunk); }
function britishVoice(){
  const voices = speechSynthesis.getVoices();
  return voices.find(v=>/en-GB/i.test(v.lang)) || voices.find(v=>/English/i.test(v.name)) || voices[0];
}
function speak(text){
  if(!("speechSynthesis" in window)) return;
  const u = new SpeechSynthesisUtterance(text);
  u.voice = britishVoice();
  u.rate = 0.85;
  speechSynthesis.cancel(); speechSynthesis.speak(u);
}

/* ========= â‘£ UIåˆæœŸåŒ– ========= */
const daySelect = document.getElementById("daySelect");
const qJa = document.getElementById("qJa");
const qEn = document.getElementById("qEn");
const choicesEl = document.getElementById("choices");
const feedbackEl = document.getElementById("feedback");
const nextBtn = document.getElementById("nextBtn");
const speakBtn = document.getElementById("speakBtn");
const titlePill = document.getElementById("titlePill");
const countPill = document.getElementById("countPill");
const scorePill = document.getElementById("scorePill");
const barFill = document.getElementById("barFill");
const progressText = document.getElementById("progressText");
const modeAllBtn = document.getElementById("modeAll");
const modeWrongBtn = document.getElementById("modeWrong");
const resetBtn = document.getElementById("resetDay");

function populateDaySelect(){
  daySelect.innerHTML = DATASET.map(d=>`<option value="${d.day}">Day ${d.day}ï½œ${d.theme}</option>`).join("");
}
function makeQueue(){
  const data = getDayData(state.day); const store = loadStore(state.day);
  const idsAll = data.items.map(i=>i.id);
  const idsWrong = data.items.filter(i=>store.wrong.includes(i.id)).map(i=>i.id);
  state.queue = (state.mode==="wrong" ? idsWrong : idsAll);
  state.idx = 0;
  if(state.queue.length===0){ state.mode="all"; modeAllBtn.classList.add("primary"); modeWrongBtn.classList.remove("primary"); state.queue = idsAll; }
}
function updateHeader(){
  const d = getDayData(state.day);
  titlePill.textContent = `Day ${d.day}ï½œ${d.theme}ï½œ${d.phrase}`;
  countPill.textContent = `Q ${Math.min(state.idx+1, state.queue.length)} / ${state.queue.length}`;
  const st = loadStore(state.day);
  scorePill.textContent = `æ­£è§£:${st.correct.length}ï½œèª¤ç­”:${st.wrong.length}`;
  const progress = state.queue.length? ((state.idx)/state.queue.length*100) : 0;
  barFill.style.width = `${progress}%`;
  progressText.textContent = `${state.idx} / ${state.queue.length}`;
}
function renderQuestion(){
  feedbackEl.textContent = ""; feedbackEl.className = "feedback";
  const d = getDayData(state.day);
  if(!d || d.items.length===0){ qJa.textContent="ã“ã®æ—¥ã¯ã¾ã å•é¡ŒãŒã‚ã‚Šã¾ã›ã‚“ã€‚"; qEn.textContent="(No data yet)"; choicesEl.innerHTML=""; return; }
  const id = state.queue[state.idx]; const item = d.items.find(x=>x.id===id);
  qJa.textContent = item.ja;
  qEn.innerHTML = item.en.replace("_____", '<span class="blank">_____</span>');
  const opts = buildChoices(item, d.items);
  choicesEl.innerHTML = "";
  opts.forEach(opt=>{
    const btn = document.createElement("button"); btn.className = "choice"; btn.textContent = opt;
    btn.onclick = ()=>checkAnswer(opt, item); choicesEl.appendChild(btn);
  });
  updateHeader();
}
function checkAnswer(opt,item){
  const correct = (opt===item.answer); state.lastResult = correct ? "ok" : "ng";
  [...choicesEl.children].forEach(b=>{
    if(b.textContent===item.answer){ b.classList.add("correct"); }
    if(b.textContent===opt && !correct){ b.classList.add("wrong"); }
    b.disabled = true;
  });
  const st = loadStore(state.day);
  if(correct){
    feedbackEl.textContent = "æ­£è§£ã§ã™ï¼ã‚ˆãã§ãã¾ã—ãŸã€‚"; feedbackEl.classList.add("ok");
    if(!st.correct.includes(item.id)) st.correct.push(item.id);
    st.wrong = st.wrong.filter(id=>id!==item.id);
    speak(fillBlank(item.en, item.answer));
  }else{
    feedbackEl.textContent = `ä¸æ­£è§£ã€‚æ­£è§£ã¯ã€Œ${item.answer}ã€ã€‚`; feedbackEl.classList.add("ng");
    if(!st.wrong.includes(item.id)) st.wrong.push(item.id);
    st.correct = st.correct.filter(id=>id!==item.id);
  }
  saveStore(state.day, st); updateHeader();
}
function next(){
  if(state.idx < state.queue.length-1){ state.idx++; renderQuestion(); }
  else{ feedbackEl.textContent = "æœ¬æ—¥ã®å‡ºé¡Œã¯ã“ã“ã¾ã§ã€‚ãŠç–²ã‚Œã•ã¾ï¼å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã§èª¤ç­”ã ã‘ã‚„ã‚Šç›´ã›ã¾ã™ã€‚"; feedbackEl.className = "feedback ok"; qEn.innerHTML = "Complete âœ…"; choicesEl.innerHTML = ""; }
}
function resetDay(){
  if(confirm("ã“ã®æ—¥ã®æˆç¸¾ï¼ˆæ­£è§£/èª¤ç­”ï¼‰ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ")){
    saveStore(state.day, {correct:[], wrong:[]}); state.idx = 0; makeQueue(); renderQuestion();
  }
}

/* ========= â‘¤ ã‚¤ãƒ™ãƒ³ãƒˆ ========= */
daySelect.addEventListener("change", e=>{
  state.day = parseInt(e.target.value,10); state.mode = "all";
  modeAllBtn.classList.add("primary"); modeWrongBtn.classList.remove("primary");
  makeQueue(); renderQuestion();
});
nextBtn.addEventListener("click", next);
speakBtn.addEventListener("click", ()=> {
  const d = getDayData(state.day); const id = state.queue[state.idx]; const item = d.items.find(x=>x.id===id);
  if(item) speak(fillBlank(item.en, item.answer));
});
modeAllBtn.addEventListener("click", ()=>{ state.mode="all"; modeAllBtn.classList.add("primary"); modeWrongBtn.classList.remove("primary"); makeQueue(); renderQuestion(); });
modeWrongBtn.addEventListener("click", ()=>{ state.mode="wrong"; modeWrongBtn.classList.add("primary"); modeAllBtn.classList.remove("primary"); makeQueue(); renderQuestion(); });
resetBtn.addEventListener("click", resetDay);
window.speechSynthesis?.addEventListener("voiceschanged",()=>{});

/* ========= â‘¥ èµ·å‹• ========= */
(function init(){ populateDaySelect(); state.day = DATASET[0].day; daySelect.value = String(state.day); modeAllBtn.classList.add("primary"); makeQueue(); renderQuestion(); })();
</script>
</body>
</html>
